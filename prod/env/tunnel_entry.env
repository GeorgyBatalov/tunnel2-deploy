# ===================================================================
# Tunnel2 ProxyEntry - Production Environment
# ===================================================================
# IMPORTANT: This file contains PRODUCTION configuration
# Secrets are loaded from Vault at runtime
# ===================================================================

# ===== Vault Configuration =====
# Vault address (internal docker network)
Vault__Address=http://tunnel2_vault:8300

# Vault token (SET THIS FROM .env FILE AFTER VAULT INITIALIZATION)
# DO NOT hardcode production token here!
Vault__Token=${VAULT_ROOT_TOKEN}

# Vault path configuration
Vault__BasePath=tunnel/proxy-entry
Vault__MountPoint=secret

# ===== TunnelServer Configuration =====
# TunnelServer address for uplink connections (internal docker network)
TunnelServer__Host=tunnel2_server
TunnelServer__Port=12002

# ===== RabbitMQ Configuration =====
# RabbitMQ for event publishing (heartbeats, tunnel lifecycle)
Rabbit__HostName=chefbot_rabbitmq
Rabbit__Port=5672
Rabbit__UserName=tunnel2_rabbitmq
Rabbit__Password=wykqam-0sojvY-zyshiz
Rabbit__VirtualHost=/tunnel2

# ===== ProxyEntry Configuration =====
# Unique identifier for this ProxyEntry instance (must match TunnelServer config)
ProxyEntry__Id=e1

# HTTP listener configuration
ProxyEntry__HttpPort=80

# Uplink listener configuration (for client connections)
ProxyEntry__UplinkPort=12001

# TCP public ports range
ProxyEntry__TcpPortRangeStart=40000
ProxyEntry__TcpPortRangeEnd=40100

# ===== TLS Certificate Configuration =====
# Path to PFX certificate (mounted from ./certs/server.pfx)
ProxyEntry__CertificatePath=/app/server.pfx
# Password loaded from Vault or set here
ProxyEntry__CertificatePassword=wykqam-0sojvY-zyshiz

# ===== Performance Tuning =====
# Kestrel limits for high load
Kestrel__Limits__MaxConcurrentConnections=5000
Kestrel__Limits__MaxConcurrentUpgradedConnections=5000
Kestrel__Limits__KeepAliveTimeout=00:02:00
Kestrel__Limits__RequestHeadersTimeout=00:00:30

# ===== Logging Configuration =====
# Serilog minimum level
Serilog__MinimumLevel__Default=Information
Serilog__MinimumLevel__Override__Microsoft=Warning
Serilog__MinimumLevel__Override__System=Warning

# ===== ASP.NET Core Environment =====
ASPNETCORE_ENVIRONMENT=Production

# ===== OpenTelemetry / Distributed Tracing (Phase 8) =====
# Enable distributed tracing with OTLP exporter to Jaeger
OpenTelemetry__Enabled=true
OpenTelemetry__OtlpEndpoint=http://jaeger:4317
